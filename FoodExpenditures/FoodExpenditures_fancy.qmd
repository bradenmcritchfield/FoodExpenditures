---
title: "FoodExpenditures"
author: "Braden Critchfield and Thomas Olsen"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r, message=FALSE,warning=FALSE}
library(tidyverse)
library(lmtest)

food <- read_delim("FoodExpenses.txt", delim=" ")
```


# 1: Exploratory Plots and Summary Statistics
```{r}
ggplot(data = food, aes(y = EatingOut, x = Income)) +
  geom_point() +
  ggtitle("Avg. Eating Out Weekly Expenditure by Income Level")

```

There seems to be a positive linear relationship between annual household income and average weekly expenditure on food not cooked at home. However, it looks like the variance might grow larger as Income grows larger.


```{r}
ggplot(data = food, aes(y = EatingOut, x = Income, group=Income)) +
  geom_boxplot() +
  ggtitle("Distributions of Eating Out Weekly Expenditure by Income Level")

```

Because Income is a discrete variable, this shows the distributions of Average weekly eating out expenditure per income level. This still shows a positive relationship between the two variables, and again shows how the variance seems to grow as the income increases.

Here are the summary statistics:
```{r}
summary(food)



```


# 2: Fit homoskedastic linear model
```{r}
food.lm <- lm(EatingOut ~ ., data = food)
summary(food.lm)


```

```{r}
ggplot()+geom_point(mapping=aes(x=fitted(food.lm), y =  resid(food.lm)))

bptest(food.lm)
```

The equal variance assumption is not met. From the residuals vs. fitted values plot, the spread of the data points grows as income grows. This is confirmed by the Breusch-Pagan test, where we can reject the null hypothesis that there is equal variance and assume the variance is unequal.

Since this assumption is not met, it affects our inference because all of our standard errors will be off, and some of our coefficients could be off as well. This could lead to us concluding variables are significant when they are not, identifying confidence intervals that are wrong, etc.

# 3: Write down heteroskedastic model
The heteroskedastic linear regression model is written as follows:

$$y \sim N(X\boldsymbol\beta, \sigma^2D(\theta)) \hspace{10pt} d_{ii} = exp(2Income_{i}\theta)$$
where 

$$
\mathbf{y} = \begin{bmatrix}
  EatingOut_1 \\
  EatingOut_2 \\
  \vdots \\
  EatingOut_n
\end{bmatrix}
$$
$$
\mathbf{X} = \begin{bmatrix}
  1 & x_1 \\
  1 & x_2 \\
  \vdots & \vdots \\
  1 & x_n
\end{bmatrix}
$$

$$
\mathbf{\boldsymbol\beta} = \begin{bmatrix}
  \beta_0 \\
  \beta_{Income}
\end{bmatrix}

$$

With this model, we will have an accurate estimation of standard error, so we can test whether income has a significant effect on eating out expenditure, as well as build a confidence interval to see what the estimated effect is.

# 4: Fit Model from Q3 to Eating Out and check assumptions




# 5: Validate predictions via cross-validation




# 6: Report Beta Hat and Variance Parameters




# 7: Test if the economy is not healthy




# 8: Predict your own restaurant spend



